

static void Action_BeepTest(void)
{
    LCD_FillRect(0, 0, 240, 320, 0x0000);
    LCD_DrawString(20, 100, "AUDIO TEST", 0xFFFF, 0x0000);
    LCD_DrawString(20, 120, "INITIALIZING AFE...", 0xFFE0, 0x0000);
    
    /* Initialize audio system */
    AFE_initialize();
    
    LCD_DrawString(20, 140, "READY!", 0x07E0, 0x0000);
    LCD_DrawString(20, 160, "1: Play Scale", 0xFFFF, 0x0000);
    LCD_DrawString(20, 180, "2: Play Melody", 0xFFFF, 0x0000);
    LCD_DrawString(20, 200, "3: Beep (Old)", 0xFFFF, 0x0000);
    LCD_DrawString(20, 240, "BACK to exit", 0x7BEF, 0x0000);
    
    boolean exitBeep = false;
    while (!exitBeep) {
        if (KP_IsKeyPressed()) {
            TKEY key = KP_ReadKey();
            switch (key) {
                case KEY_1: // Scale
                    LCD_DrawString(20, 220, "Playing Scale...", 0x07E0, 0x0000);
                    /* Play a scale (approximate values) */
                    /* Lower value = Higher pitch */
                    PlayTone(30, 200); // Do
                    PlayTone(27, 200); // Re
                    PlayTone(24, 200); // Mi
                    PlayTone(22, 200); // Fa
                    PlayTone(20, 200); // Sol
                    PlayTone(18, 200); // La
                    PlayTone(16, 200); // Si
                    PlayTone(15, 200); // Do
                    LCD_DrawString(20, 220, "Done!           ", 0xFFFF, 0x0000);
                    break;
                    
                case KEY_2: // Melody (Twinkle Twinkle)
                    LCD_DrawString(20, 220, "Playing Melody...", 0x07E0, 0x0000);
                    /* Twinkle Twinkle Little Star */
                    PlayTone(30, 300); PlayTone(30, 300); // Do Do
                    PlayTone(20, 300); PlayTone(20, 300); // Sol Sol
                    PlayTone(18, 300); PlayTone(18, 300); // La La
                    PlayTone(20, 600);                    // Sol
                    
                    PlayTone(22, 300); PlayTone(22, 300); // Fa Fa
                    PlayTone(24, 300); PlayTone(24, 300); // Mi Mi
                    PlayTone(27, 300); PlayTone(27, 300); // Re Re
                    PlayTone(30, 600);                    // Do
                    LCD_DrawString(20, 220, "Done!            ", 0xFFFF, 0x0000);
                    break;
                    
                case KEY_3: // Old Beep
                    LCD_DrawString(20, 220, "Beeping...      ", 0x07E0, 0x0000);
                    Beep();
                    LCD_DrawString(20, 220, "Done!           ", 0xFFFF, 0x0000);
                    break;
                    
                case KEY_BACK:
                    exitBeep = true;
                    break;
                default:
                    break;
            }
        }
        USC_Pause_us(50000);
        RGU_RestartWDT();
    }
    
    Menu_InvalidateCache();
}
